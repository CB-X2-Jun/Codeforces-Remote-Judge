<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Codeforces远端评测</title>
<style>
body{font-family: Arial; max-width:800px;margin:30px auto;}
label,input,select,textarea,button{display:block;margin-bottom:10px;width:100%;}
textarea{height:300px;font-family: monospace;}
button{padding:8px;background:#4CAF50;color:white;border:none;cursor:pointer;}
button:hover{background:#45a049;}
.result{padding:10px;border-radius:5px; margin:5px 0; font-weight:bold;}
</style>
</head>
<body>
<h2>Codeforces远端评测</h2>
<label>JSESSIONID: <input id="jsessionid"></label>
<label>用户名: <input id="username"></label>
<label>题号: <input id="problem" placeholder="例如 1A"></label>
<label>语言:
<select id="language">
<option value="54">GNU G++17 7.3.0</option>
<option value="43">GNU GCC C11 5.1.0</option>
<option value="87">Java 21 64bit</option>
</select>
</label>
<label>源代码:<br><textarea id="source"></textarea></label>
<button onclick="submitCode()">提交</button>

<h3>提交结果:</h3>
<pre id="result"></pre>

<script>
async function submitCode(){
    const data = {
        jsessionid: document.getElementById("jsessionid").value,
        problem: document.getElementById("problem").value,
        language: document.getElementById("language").value,
        source: document.getElementById("source").value
    };
    const resultEl = document.getElementById("result");
    resultEl.textContent = "提交中，请稍候...";
    try{
        const res = await fetch("/.netlify/functions/submit_code", {
            method:"POST",
            headers: {"Content-Type":"application/json"},
            body: JSON.stringify(data)
        });
        const json = await res.json();
        resultEl.textContent = JSON.stringify(json,null,2);
    }catch(e){
        resultEl.textContent = e;
    }
}
</script>
</body>
</html>
